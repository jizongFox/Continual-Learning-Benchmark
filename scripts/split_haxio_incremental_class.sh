set -e
GPUID=$1
OUTDIR=outputs/split_HaxioDataset_incremental_class
REPEAT=1
dataroot=data/medxl_v2

mkdir -p $OUTDIR
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --lr 0.001 --offline_training | tee ${OUTDIR}/Offline_Adam_resnet18.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --lr 0.001 | tee ${OUTDIR}/Adam.log

python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 30 | tee ${OUTDIR}/L2_30.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 20 | tee ${OUTDIR}/L2_20.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 15 | tee ${OUTDIR}/L2_15.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 12 | tee ${OUTDIR}/L2_12.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 10 | tee ${OUTDIR}/L2_10.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 8 | tee ${OUTDIR}/L2_08.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2 --lr 0.001 --reg_coef 5 | tee ${OUTDIR}/L2_05.log

python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC --lr 0.001 --reg_coef 10 | tee ${OUTDIR}/EWC_10.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC --lr 0.001 --reg_coef 20 | tee ${OUTDIR}/EWC_20.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC --lr 0.001 --reg_coef 2 | tee ${OUTDIR}/EWC_2.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC --lr 0.001 --reg_coef 1 | tee ${OUTDIR}/EWC_1.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC --lr 0.001 --reg_coef 5 | tee ${OUTDIR}/EWC_5.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC --lr 0.001 --reg_coef 0.1 | tee ${OUTDIR}/EWC_0.1.log

python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC_online --lr 0.001 --reg_coef 20 | tee ${OUTDIR}/EWC_online_20.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC_online --lr 0.001 --reg_coef 2 | tee ${OUTDIR}/EWC_online_2.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC_online --lr 0.001 --reg_coef 1 | tee ${OUTDIR}/EWC_online_1.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC_online --lr 0.001 --reg_coef 5 | tee ${OUTDIR}/EWC_online_5.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name EWC_online --lr 0.001 --reg_coef 0.1 | tee ${OUTDIR}/EWC_online_0.1.log
#python -u iBatchLearn.py --dataset HaxioDataset  --dataroot=$dataroot  --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam    --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization  --agent_name EWC_online --lr 0.001 --reg_coef 2            | tee ${OUTDIR}/EWC_online.log

#python -u iBatchLearn.py --dataset HaxioDataset  --dataroot=$dataroot  --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam    --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name SI         --lr 0.001 --reg_coef 0.001        | tee ${OUTDIR}/SI.log
#python -u iBatchLearn.py --dataset HaxioDataset  --dataroot=$dataroot  --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam    --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name L2         --lr 0.001 --reg_coef 500          | tee ${OUTDIR}/L2.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name Naive_Rehearsal_1400 --lr 0.001 | tee ${OUTDIR}/Naive_Rehearsal_1400.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type customization --agent_name Naive_Rehearsal_5600 --lr 0.001 | tee ${OUTDIR}/Naive_Rehearsal_5600.log
#python -u iBatchLearn.py --dataset HaxioDataset  --dataroot=$dataroot  --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam    --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type regularization --agent_name MAS        --lr 0.001 --reg_coef 0.001        |tee  ${OUTDIR}/MAS.log

python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type exp_replay --agent_name Naive_Rehearsal_EWC --lr 0.001 --reg_coef 2 | tee ${OUTDIR}/Naive_Rehearsal_EWC_2.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type exp_replay --agent_name Naive_Rehearsal_EWC --lr 0.001 --reg_coef 4 | tee ${OUTDIR}/Naive_Rehearsal_EWC_4.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type exp_replay --agent_name Naive_Rehearsal_EWC --lr 0.001 --reg_coef 6 | tee ${OUTDIR}/Naive_Rehearsal_EWC_6.log
python -u iBatchLearn.py --dataset HaxioDataset --dataroot=$dataroot --train_aug --gpuid $GPUID --repeat $REPEAT --incremental_class --optimizer Adam --force_out_dim 7 --no_class_remap --first_split_size 3 --other_split_size 2 --schedule 10 15 20 --batch_size 16 --model_name resnet18 --model_type resnet2 --agent_type exp_replay --agent_name Naive_Rehearsal_EWC --lr 0.001 --reg_coef 8 | tee ${OUTDIR}/Naive_Rehearsal_EWC_8.log
